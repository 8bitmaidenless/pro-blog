{% extends "base.html" %}
{% load uitags blog_tags %}
{% block title %}Search{% endblock %}
{% block banner %}
    <h1 class="title">
        {% if query %}
        Results for <em>{{ query }}</em>
        {% else %}
        Search for posts
        {% endif %}
    </h1>
{% endblock %}
{% block content %}
    <div class="columns">
        <div class="column is-four-fifths">
            {% if query %}
            {% for post in results %}
            <div class="block">
                <div class="media box">
                    <div class="media-content">
                        <div class="content">
                            <a href="{{ post.get_absolute_url }}">
                                <p class="is-size-5 has-text-weight-semibold">{{ post.title }}</p>
                                <div class="tags is-right">
                                    {% for tag in post.tags.all %}
                                    <span class="tag is-{% cycle 'primary' 'link' %}">{{ tag.name }}</span>
                                    {% empty %}
                                    <span class="tag is-light has-text-weight-light is-italic">No tags</span>
                                    {% endfor %}
                                </div>
                                <div class="indented">
                                    {{ post.body|markdown|truncatewords_html:12 }}
                                </div>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            {% empty %}
            <div class="block">
                <div class="notification is-warning">
                    <button type="button" class="delete"></button>
                    <div class="content indented">
                        <p>
                            Sorry, but no results were found that satisfy your search query.
                            Please, refine your search terms and try again.
                        </p>
                    </div>
                </div>
            </div>
            {% endfor %}
            {% else %}
            <div class="block">
                <div class="box">
                    <form method="get" action="{% url 'blog:post_search' %}">
                        {% csrf_token %}
                        {{ form|bulma }}
                        <div class="field">
                            <p class="control">
                                <input type="submit" class="button is-primary" value="Search" />
                            </p>
                        </div>
                    </form>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
{% endblock %}